(this["webpackJsonploop-frontend"]=this["webpackJsonploop-frontend"]||[]).push([[0],{68:function(t,e,n){"use strict";n.r(e);var a=n(0),s=n(1),r=n(18),i=n.n(r),c=n(5),o=n(6),l=n(4),u=n(11),d=n(10),h=n(14),b=n(2),j=n(16),p=n(13),m=n.n(p),O="http://myhost.com",f="".concat(O),g="".concat(O,"/api"),v="jwt",x=new(function(){function t(){Object(c.a)(this,t)}return Object(o.a)(t,[{key:"login",value:function(t,e,n){m.a.post("".concat(f,"/login"),{username:t,password:e}).then((function(t){var e=t.headers.authorization.replace("Bearer ","");sessionStorage.setItem(v,e),n(!0)})).catch((function(t){console.error(t),n(!1)}))}},{key:"getJWTToken",value:function(){return sessionStorage.getItem(v)}},{key:"isAuthenticated",value:function(){return null!=this.getJWTToken()}},{key:"logout",value:function(){sessionStorage.removeItem(v)}},{key:"getJWTTokenData",value:function(){var t=this.getJWTToken();if(null==t)return null;var e=atob(t.split(".")[1]);return JSON.parse(e)}}]),t}()),k=function(t){return Object(a.jsx)("div",{className:"alert alert-danger",role:"alert",children:t.message})},y=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={username:"",password:"",alert:null,processing:!1,loggedIn:!1},a.handleSubmit=a.handleSubmit.bind(Object(l.a)(a)),a.handleInputChanged=a.handleInputChanged.bind(Object(l.a)(a)),a.handleLoginReponse=a.handleLoginReponse.bind(Object(l.a)(a)),a}return Object(o.a)(n,[{key:"handleSubmit",value:function(t){t.preventDefault(),this.setState({processing:!0}),x.login(this.state.username,this.state.password,this.handleLoginReponse)}},{key:"handleLoginReponse",value:function(t){t?(this.setState({loggedIn:!0,processing:!1}),this.props.onLoginSuccess()):this.setState({alert:"O login n\xe3o pode ser realizado",processing:!1})}},{key:"handleInputChanged",value:function(t){var e=t.target.name,n=t.target.value;this.setState(Object(j.a)({},e,n))}},{key:"render",value:function(){return x.isAuthenticated()||this.state.loggedIn?Object(a.jsx)(b.a,{to:"/"}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:" Login "}),null!==this.state.alert?Object(a.jsx)(k,{message:this.state.alert}):"",Object(a.jsxs)("form",{onSubmit:this.handleSubmit,children:[Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"username",children:"Usu\xe1rio"}),Object(a.jsx)("input",{type:"text",className:"form-control",onChange:this.handleInputChanged,value:this.state.username,name:"username",placeholder:"Digite o usu\xe1rio"})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"password",children:"Senha"}),Object(a.jsx)("input",{type:"password",className:"form-control",onChange:this.handleInputChanged,value:this.state.password,name:"password",placeholder:"Digite a senha"})]}),Object(a.jsx)("br",{}),Object(a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:this.state.processing,children:"Login"})]})]})}}]),n}(s.Component),S=n(36),C=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(){return Object(c.a)(this,n),e.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){var t=this;return Object(a.jsx)("div",{children:Object(a.jsx)(h.b,{className:"nav-item nav-link ".concat(this.props.item.active?"active":""),to:this.props.item.href,onClick:function(e){return t.props.onClick(t.props.item)},children:this.props.item.name})})}}]),n}(s.Component),H=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={items:[{name:"Listar Tarefas",href:"/",active:!1},{name:"Nova Tarefa",href:"/form",active:!1}]},a.onClickHandler=a.onClickHandler.bind(Object(l.a)(a)),a.onLogoutHandler=a.onLogoutHandler.bind(Object(l.a)(a)),a}return Object(o.a)(n,[{key:"onClickHandler",value:function(t){var e=this,n=Object(S.a)(this.state.items);n.forEach((function(a){a.name===t.name?a.active=!0:a.active=!1,e.setState({items:n})}))}},{key:"onLogoutHandler",value:function(){x.logout(),this.props.onLinkClick()}},{key:"render",value:function(){var t=this;return Object(a.jsx)("div",{children:Object(a.jsxs)("nav",{className:"navbar navbar-expand-lg navbar-light bg-light",children:[Object(a.jsx)("a",{className:"navbar-brand",href:"/",children:"LoopTasks"}),Object(a.jsx)("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarText","aria-controls":"navbarText","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(a.jsx)("span",{className:"navbar-toggler-icon"})}),Object(a.jsx)("div",{className:"collapse navbar-collapse",id:"navbarText",children:Object(a.jsxs)("ul",{className:"navbar-nav mr-auto",children:[this.state.items.map((function(e){return Object(a.jsx)(C,{item:e,onClick:t.onClickHandler},e.name)})),x.isAuthenticated()?Object(a.jsx)(C,{item:{name:"Logout",active:!1,href:"#"},onClick:this.onLogoutHandler}):""]})}),Object(a.jsx)("span",{className:"navbar-text",children:x.isAuthenticated()?"Ol\xe1, ".concat(x.getJWTTokenData().displayName,"!"):""})]})})}}]),n}(s.Component),T=n(24),N=new(function(){function t(){Object(c.a)(this,t)}return Object(o.a)(t,[{key:"list",value:function(t,e){m.a.get("".concat(g,"/tasks?sort=whenToDo,asc"),this.buildAuthHeader()).then((function(e){return t(e.data.content)})).catch((function(t){return e(t)}))}},{key:"load",value:function(t,e,n){m.a.get("".concat(g,"/tasks/").concat(t),this.buildAuthHeader()).then((function(t){return e(t.data)})).catch((function(t){return n(t)}))}},{key:"delete",value:function(t,e,n){m.a.delete("".concat(g,"/tasks/").concat(t),this.buildAuthHeader()).then((function(){return e()})).catch((function(t){return n(t)}))}},{key:"save",value:function(t,e,n){0===t.id?m.a.post("".concat(g,"/tasks"),t,this.buildAuthHeader()).then((function(){return e()})).catch((function(t){return n(t)})):m.a.put("".concat(g,"/tasks/").concat(t.id),t,this.buildAuthHeader()).then((function(){return e()})).catch((function(t){return n(t)}))}},{key:"buildAuthHeader",value:function(){return{headers:{authorization:"Bearer ".concat(x.getJWTToken())}}}}]),t}()),D=function(){return Object(a.jsx)("div",{className:"d-flex justify-content-center",children:Object(a.jsx)("div",{className:"spinner-border",role:"status"})})},E=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={task:{id:0,description:"",whenToDo:""},redirect:!1,buttomName:"Cadastrar",alert:null,loading:!1,saving:!1},a.onSubmitHandler=a.onSubmitHandler.bind(Object(l.a)(a)),a.onInputChangeHandler=a.onInputChangeHandler.bind(Object(l.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=this.props.match.params.id;e&&(this.setState({loading:!0}),N.load(~~e,(function(e){return t.setState({task:e,loading:!1,buttomName:"Alterar"})}),(function(e){e.response?404===e.response.status?t.setErrorState("Tarefa n\xe3o encontrada"):t.setErrorState("Erro ao carregar dados: ".concat(e.response)):t.setErrorState("Erro na requisi\xe7\xe3o: ".concat(e.message))})))}},{key:"setErrorState",value:function(t){this.setState({alert:t,loading:!1,saving:!1})}},{key:"onSubmitHandler",value:function(t){var e=this;t.preventDefault(),this.setState({saving:!0,alert:null}),N.save(this.state.task,(function(){return e.setState({redirect:!0,saving:!1})}),(function(t){t.response?e.setErrorState("Erro: ".concat(t.response.data.error)):e.setErrorState("Erro na requisi\xe7\xe3o: ".concat(t.message))}))}},{key:"onInputChangeHandler",value:function(t){var e=t.target.name,n=t.target.value;this.setState((function(t){return{task:Object(T.a)(Object(T.a)({},t.task),{},Object(j.a)({},e,n))}})),console.log(this.state.task)}},{key:"render",value:function(){var t=this;return x.isAuthenticated()?this.state.redirect?Object(a.jsx)(b.a,{to:"/"}):this.state.loading?Object(a.jsx)(D,{}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Cadastro da Tarefa"}),null!=this.state.alert?Object(a.jsx)(k,{message:this.state.alert}):"",Object(a.jsxs)("form",{onSubmit:this.onSubmitHandler,children:[Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"description",children:"Descri\xe7\xe3o"}),Object(a.jsx)("input",{type:"text",className:"form-control",name:"description",value:this.state.task.description,placeholder:"Digite a descri\xe7\xe3o",onChange:this.onInputChangeHandler})]}),Object(a.jsxs)("div",{className:"form-group",children:[Object(a.jsx)("label",{htmlFor:"whenToDo",children:"Data"}),Object(a.jsx)("input",{type:"date",className:"form-control",name:"whenToDo",value:this.state.task.whenToDo,placeholder:"Informe a data",onChange:this.onInputChangeHandler})]}),Object(a.jsx)("br",{}),Object(a.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:this.state.saving,children:this.state.saving?Object(a.jsx)("span",{className:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"}):this.state.buttomName}),"\xa0\xa0",Object(a.jsx)("button",{type:"button",className:"btn btn-primary",onClick:function(){return t.setState({redirect:!0})},children:"Cancelar"})]})]}):Object(a.jsx)(b.a,{to:"/login"})}}]),n}(s.Component),I=n(19),w=(n(65),n(25)),L=n.n(w),A=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).state={tasks:[],editId:0,loading:!1,alert:null},a.onDeleteHandler=a.onDeleteHandler.bind(Object(l.a)(a)),a.onStatusChangeHandler=a.onStatusChangeHandler.bind(Object(l.a)(a)),a.onEditHandler=a.onEditHandler.bind(Object(l.a)(a)),a}return Object(o.a)(n,[{key:"componentDidMount",value:function(){this.listTasks()}},{key:"listTasks",value:function(){var t=this;x.isAuthenticated()&&(this.setState({loading:!0}),N.list((function(e){return t.setState({tasks:e,loading:!1})}),(function(e){return t.setErrorState(e)})))}},{key:"setErrorState",value:function(t){this.setState({alert:"Erro na requisi\xe7\xe3o:  ".concat(t.message),loading:!1})}},{key:"onDeleteHandler",value:function(t){var e=this;window.confirm("Deseja mesmo excluir essa tarefa?")&&N.delete(t,(function(){e.listTasks(),I.b.success("Tarefa exclu\xedda!",{position:I.b.POSITION.BOTTOM_LEFT})}),(function(t){return e.setErrorState(t)}))}},{key:"onEditHandler",value:function(t){this.setState({editId:t})}},{key:"onStatusChangeHandler",value:function(t){var e=this;t.done=!t.done,N.save(t,(function(){var n=e.state.tasks.map((function(e){return e.id!==t.id?e:t}));e.setState({tasks:n})}),(function(t){return e.setErrorState(t)}))}},{key:"render",value:function(){return x.isAuthenticated()?this.state.editId>0?Object(a.jsx)(b.a,{to:"/form/".concat(this.state.editId)}):Object(a.jsxs)("div",{children:[Object(a.jsx)("h1",{children:"Lista de Tarefas"}),null!=this.state.alert?Object(a.jsx)(k,{message:this.state.alert}):"",this.state.loading?Object(a.jsx)(D,{}):Object(a.jsxs)("table",{className:"table table-striped",children:[Object(a.jsx)(J,{}),this.state.tasks.length>0?Object(a.jsx)(R,{tasks:this.state.tasks,onDelete:this.onDeleteHandler,onEdit:this.onEditHandler,onStatusChange:this.onStatusChangeHandler}):Object(a.jsx)(Y,{})]}),Object(a.jsx)(I.a,{autoClose:1500})]}):Object(a.jsx)(b.a,{to:"/login"})}}]),n}(s.Component),J=function(){return Object(a.jsx)("thead",{className:"table-dark",children:Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{scope:"col",children:"Status"}),Object(a.jsx)("th",{scope:"col",children:"Descri\xe7\xe3o"}),Object(a.jsx)("th",{scope:"col",children:"Data"}),Object(a.jsx)("th",{scope:"col",children:"A\xe7\xf5es"})]})})},R=function(t){return Object(a.jsx)("tbody",{children:t.tasks.map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsxs)("td",{children:[Object(a.jsx)("input",{type:"checkbox",checked:e.done,onChange:function(){return t.onStatusChange(e)}})," "]}),Object(a.jsx)("td",{children:e.done?Object(a.jsxs)("s",{children:[" ",e.description," "]}):e.description}),Object(a.jsx)("td",{children:e.done?Object(a.jsxs)("s",{children:[" ",Object(a.jsx)(L.a,{format:"DD/MM/YYYY",children:e.whenToDo})," "]}):Object(a.jsx)(L.a,{format:"DD/MM/YYYY",children:e.whenToDo})}),Object(a.jsxs)("td",{children:[Object(a.jsx)("input",{className:"btn btn-primary",type:"button",value:"Editar",onClick:function(){return t.onEdit(e.id)}}),"\xa0",Object(a.jsx)("input",{className:"btn btn-danger",type:"button",value:"Excluir",onClick:function(){return t.onDelete(e.id)}})]})]},e.id)}))})},Y=function(t){return Object(a.jsx)("tbody",{children:Object(a.jsx)("tr",{children:Object(a.jsx)("td",{colSpan:"4",children:"Sem tarefas cadastradas no momento!"})})})},M=A,W=function(t){Object(u.a)(n,t);var e=Object(d.a)(n);function n(t){var a;return Object(c.a)(this,n),(a=e.call(this,t)).onRefreshHandler=a.onRefreshHandler.bind(Object(l.a)(a)),a}return Object(o.a)(n,[{key:"onRefreshHandler",value:function(){this.forceUpdate()}},{key:"render",value:function(){var t=this;return Object(a.jsx)(h.a,{children:Object(a.jsxs)("div",{className:"App",children:[Object(a.jsx)(H,{onLinkClick:this.onRefreshHandler}),Object(a.jsx)("div",{className:"container",style:{marginTop:20},children:Object(a.jsxs)(b.d,{children:[Object(a.jsx)(b.b,{exact:!0,path:"/form",component:E}),Object(a.jsx)(b.b,{exact:!0,path:"/login",render:function(){return Object(a.jsx)(y,{onLoginSuccess:t.onRefreshHandler})}}),Object(a.jsx)(b.b,{exact:!0,path:"/form/:id",component:E}),Object(a.jsx)(b.b,{path:"/",component:M})]})})]})})}}]),n}(s.Component);i.a.render(Object(a.jsx)(W,{}),document.getElementById("root"))}},[[68,1,2]]]);
//# sourceMappingURL=main.f5a1166d.chunk.js.map