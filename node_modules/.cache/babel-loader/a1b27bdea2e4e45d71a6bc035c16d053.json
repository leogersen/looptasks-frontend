{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport axios from \"axios\";\nimport { useContext, useState } from \"react\";\nimport { API_ENDPOINT } from \"../constants\";\nimport { AuthContext } from \"./useAuth\";\nexport const useTasks = () => {\n  _s();\n\n  const auth = useContext(AuthContext);\n  const [taskList, setTaskList] = useState([]);\n  const [error, setError] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [taskRemoved, setTaskRemoved] = useState(null);\n  const [taskUpdated, setTaskUpdated] = useState(null);\n  const [taskLoaded, setTaskLoaded] = useState(null);\n\n  const list = async () => {\n    try {\n      setProcessing(true);\n      setError(null);\n      const response = await axios.get(`${API_ENDPOINT}/tasks?sort=whenToDo,asc`, buildAuthHeader());\n      const content = response.data.content;\n\n      if (content.length === 1 && content[0].value && content.value.length === 0) {\n        setTaskList([]);\n      } else {\n        setTaskList(content);\n      }\n\n      setProcessing(false);\n    } catch (error) {\n      handleError(error);\n    }\n  };\n\n  const remove = async taskToRemove => {\n    try {\n      await axios.delete(`${API_ENDPOINT}/tasks/${taskToRemove.id}`, buildAuthHeader());\n      setTaskList(taskList.filter(task => taskToRemove.id !== task.id));\n      setTaskRemoved(taskToRemove);\n    } catch (error) {\n      handleError(error);\n    }\n  };\n\n  const save = async (taskToSave, onlyStatus = false) => {\n    try {\n      setProcessing(!onlyStatus);\n      setTaskUpdated(null);\n      setError(null);\n\n      if (taskToSave.id === 0) {\n        await axios.post(`${API_ENDPOINT}/tasks`, taskToSave, buildAuthHeader());\n      } else {\n        await axios.put(`${API_ENDPOINT}/tasks/${taskToSave.id}`, taskToSave, buildAuthHeader());\n      }\n\n      setProcessing(false);\n      setTaskUpdated(taskToSave);\n    } catch (error) {\n      handleError(error);\n    }\n  };\n\n  const load = async id => {\n    try {\n      setProcessing(true);\n      setError(null);\n      setTaskLoaded(null);\n      const response = await axios.get(`${API_ENDPOINT}/tasks/${id}`, buildAuthHeader());\n      setTaskLoaded(response.data);\n      setProcessing(false);\n    } catch (error) {\n      handleError(error);\n    }\n  };\n\n  const clearTaskRemoved = () => {\n    setTaskRemoved(null);\n  };\n\n  const clearTaskUpdated = () => {\n    setTaskUpdated(null);\n  };\n\n  const clearTaskLoaded = () => {\n    setTaskLoaded(null);\n  };\n\n  const buildAuthHeader = () => {\n    return {\n      headers: {\n        \"authorization\": `Bearer ${auth.credentials.token}`\n      }\n    };\n  };\n\n  const handleError = error => {\n    console.log(error);\n    const resp = error.response;\n\n    if (resp && resp.status === 400 && resp.data) {\n      setError(resp.data.error);\n    } else {\n      setError(error.message);\n    }\n\n    setProcessing(false);\n  };\n\n  return {\n    taskList,\n    error,\n    processing,\n    taskRemoved,\n    taskUpdated,\n    taskLoaded,\n    list,\n    remove,\n    save,\n    load,\n    clearTaskRemoved,\n    clearTaskUpdated,\n    clearTaskLoaded\n  };\n};\n\n_s(useTasks, \"31srwvWHl8thDjwD3It6qzAjgfQ=\");","map":{"version":3,"sources":["C:/Users/leand/Documents/workspace/looptasks-frontend/src/hooks/useTasks.js"],"names":["axios","useContext","useState","API_ENDPOINT","AuthContext","useTasks","auth","taskList","setTaskList","error","setError","processing","setProcessing","taskRemoved","setTaskRemoved","taskUpdated","setTaskUpdated","taskLoaded","setTaskLoaded","list","response","get","buildAuthHeader","content","data","length","value","handleError","remove","taskToRemove","delete","id","filter","task","save","taskToSave","onlyStatus","post","put","load","clearTaskRemoved","clearTaskUpdated","clearTaskLoaded","headers","credentials","token","console","log","resp","status","message"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport { useContext, useState } from \"react\";\r\nimport { API_ENDPOINT } from \"../constants\";\r\nimport { AuthContext } from \"./useAuth\";\r\n\r\nexport const useTasks = () => {\r\n    const auth = useContext(AuthContext);\r\n    const [taskList, setTaskList] = useState([]);\r\n    const [error, setError] = useState(null);\r\n    const [processing, setProcessing] = useState(false);\r\n    const [taskRemoved, setTaskRemoved] = useState(null);\r\n    const [taskUpdated, setTaskUpdated] = useState(null);\r\n    const [taskLoaded, setTaskLoaded] = useState(null);\r\n\r\n\r\n    const list = async () => {\r\n\r\n        try {\r\n            setProcessing(true);\r\n            setError(null);\r\n            const response = await axios\r\n                .get(`${API_ENDPOINT}/tasks?sort=whenToDo,asc`, buildAuthHeader());\r\n            const content = response.data.content;\r\n\r\n            if( content.length === 1 && content[0].value && content.value.length === 0) {\r\n                setTaskList([]);\r\n            }else {\r\n                setTaskList(content);\r\n                \r\n            }   \r\n            setProcessing(false);\r\n\r\n        } catch (error) {\r\n            handleError(error);\r\n\r\n        }\r\n    }\r\n\r\n\r\n    const remove = async (taskToRemove) => {\r\n        try {\r\n            await axios\r\n                .delete(`${API_ENDPOINT}/tasks/${taskToRemove.id}`, buildAuthHeader());\r\n            setTaskList(taskList.filter(task => taskToRemove.id !== task.id));\r\n            setTaskRemoved(taskToRemove);\r\n\r\n        } catch (error) {\r\n            handleError(error);\r\n\r\n        }\r\n    }\r\n\r\n    const save = async (taskToSave, onlyStatus = false) => {\r\n        try {\r\n\r\n            setProcessing(!onlyStatus);\r\n            setTaskUpdated(null);\r\n            setError(null);\r\n\r\n            if (taskToSave.id === 0) {\r\n                await axios\r\n                    .post(`${API_ENDPOINT}/tasks`, taskToSave, buildAuthHeader());\r\n            } else {\r\n                await axios\r\n                    .put(`${API_ENDPOINT}/tasks/${taskToSave.id}`, taskToSave, buildAuthHeader());\r\n            }\r\n\r\n            setProcessing(false);\r\n            setTaskUpdated(taskToSave);\r\n\r\n        } catch (error) {\r\n            handleError(error);\r\n        }\r\n    }\r\n\r\n    const load = async (id) => {\r\n        try {\r\n            setProcessing(true);\r\n            setError(null);\r\n            setTaskLoaded(null);\r\n            const response = await axios\r\n                .get(`${API_ENDPOINT}/tasks/${id}`, buildAuthHeader());\r\n                setTaskLoaded(response.data);\r\n                setProcessing(false);\r\n        } catch (error) {\r\n            handleError(error);\r\n\r\n        }\r\n    }\r\n\r\n    const clearTaskRemoved = () => {\r\n        setTaskRemoved(null);\r\n    }\r\n\r\n    const clearTaskUpdated = () => {\r\n        setTaskUpdated(null);\r\n    }\r\n    const clearTaskLoaded = () => {\r\n        setTaskLoaded(null);\r\n    }\r\n\r\n    const buildAuthHeader = () => {\r\n        return {\r\n            headers: {\r\n                \"authorization\": `Bearer ${auth.credentials.token}`\r\n            }\r\n        }\r\n    }\r\n\r\n    const handleError = (error) => {\r\n        console.log(error);\r\n        const resp = error.response;\r\n\r\n        if (resp && resp.status === 400 && resp.data) {\r\n            setError(resp.data.error);\r\n        } else {\r\n            setError(error.message);\r\n        }\r\n\r\n        setProcessing(false);\r\n    }\r\n\r\n    return { taskList, error, processing, taskRemoved, taskUpdated, taskLoaded, list, remove, save, load, clearTaskRemoved, clearTaskUpdated, clearTaskLoaded };\r\n\r\n}"]},"metadata":{},"sourceType":"module"}